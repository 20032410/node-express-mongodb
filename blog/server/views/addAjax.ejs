<% include header.ejs %>
<div class="formContainer">
  <form class="form-horizontal newsletterForm" method="post" action="">
    <div class="form-group">
      <label for="inputEmail3" class="col-sm-2 control-label">name</label>
      <div class="col-sm-10">
        <input type="text" class="form-control" id="name" name="name" placeholder="name">
      </div>
    </div>
    <div class="form-group">
      <label for="inputPassword3" class="col-sm-2 control-label">title</label>
      <div class="col-sm-10">
        <input type="text" class="form-control" id="title" name="title" placeholder="title">
      </div>
    </div>
    <div class="form-group">
      <label for="inputPassword3" class="col-sm-2 control-label">info</label>
      <div class="col-sm-10">
        <input type="text" class="form-control" id="info" name="info" placeholder="info">
      </div>
    </div>
    <div class="form-group">
      <div class="col-sm-offset-2 col-sm-10">
        <button type="submit" class="btn btn-default">add</button>
      </div>
    </div>
  </form>
</div>
<% include footer.ejs %>

<script>
/*
//此方法需要序列化表单 $(".newsletterForm").serialize()
$(function() {
  $('.newsletterForm').on('submit',function(evt){
    evt.preventDefault();
    var url = "/blog/addAjax?form=newsletter";
    var $container = $(this).closest('.formContainer');
    $.ajax({
      url:url,
      type:'POST',
      data:$(".newsletterForm").serialize(),
      success:function(data){
        if(data.status){
          $container.html("<h2>success</h2>");
        }
        else{
          $container.html("<h2>There is a problem</h2>");
        }
      },
      error:function(){
        $container.html("<h2>There is a problem</h2>");
      }
    });
  });
});
*/
$(function() {
  //表单专门提交
  $('form').ajaxForm({
    beforeSerialize: function() {
      console.log('beforeSerialize')
    },
    beforeSubmit: function() {
      console.log('beforeSubmit')
    },
    success: function(data, status, xhr, $form) {
      console.log(data)
      var status = data.status;
      if (status) {
        alert("添加成功");
        $form[0].reset();
      } else {
        alert("添加失败");
      }
    },
    err: function() {
      alert("系统繁忙");
    }
  })
})
</script>